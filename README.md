# üß† **Dynamic_SSIM_Analysis**

–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö –∫–∞–¥—Ä–æ–≤ –≤ –≤–∏–¥–µ–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç—Ä–∏–∫–∏ SSIM (Structural Similarity Index) . –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–∞—Å–∫–∏—Ä–æ–≤–∫—É –ª–µ–∫—Ç–æ—Ä–∞ –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Å–ª–∞–π–¥–æ–≤ –∏ —Å—Ç–∞—Ç–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω.

## üìå **–û–ø–∏—Å–∞–Ω–∏–µ**

–≠—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤–∏–¥–µ–æ, –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∫–∞–¥—Ä—ã, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ü–≤–µ—Ç–æ–≤–æ–π SSIM –º–µ–∂–¥—É —Å–æ—Å–µ–¥–Ω–∏–º–∏ –∫–∞–¥—Ä–∞–º–∏ –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞–∏–±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —É—á–∞—Å—Ç–∫–∏ ‚Äî –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ –∫–∞–¥—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–∞–π–¥—ã, –∑–∞—Å—Ç–∞–≤–∫–∏).

## ‚úÖ **–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**

–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–∞–¥—Ä–æ–≤ –∏–∑ –≤–∏–¥–µ–æ
–†–∞—Å—á—ë—Ç —Ü–≤–µ—Ç–æ–≤–æ–≥–æ SSIM –º–µ–∂–¥—É –∫–∞–¥—Ä–∞–º–∏
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö –∫–∞–¥—Ä–æ–≤
–ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ –ª–µ–∫—Ç–æ—Ä–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF-–æ—Ç—á—ë—Ç–∞ —Å –ø—Ä–µ–≤—å—é –∫–ª—é—á–µ–≤—ã—Ö –∫–∞–¥—Ä–æ–≤

## üß∞ **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º Python 3.8+ –∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```python
pip install -r requirements.txt
```
üîß –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (requirements.txt):
```python
opencv-python
mediapipe
numpy
pandas
moviepy
tqdm
Pillow
reportlab
scikit-image
```
–î–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è multiprocessing. 


**–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É**
```python
# --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è VideoSSIMPipeline ---
pipeline = VideoSSIMPipeline(
    # –ü—É—Ç—å –∫ –≤–∏–¥–µ–æ—Ñ–∞–π–ª—É, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è
    video_path='/content/drive/MyDrive/Trafary/dataset/–î–ª—è –Ω–µ–∏ÃÜ—Ä–æ–Ω–∫–∏ (–≤—Ä–µ–º–µ–Ω–Ω–æ–µ)/–ü—Ä–æ–¥–∞—é—â–∏–∏ÃÜ —Å–µ—Ä–≤–∏—Å –≤–∏–¥–µ–æ/1rs –í–≤–µ–¥–µ–Ω–∏–µ –≤ –∫—É—Ä—Å –ü—Ä–æ–¥–∞—é—â–∏–∏%U0306 —Å–µ—Ä–≤–∏—Å.mp4',
    mask_lector=True, # –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –±—É–¥–µ—Ç –ª–∏ –º–∞—Å–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è –ª–µ–∫—Ç–æ—Ä (—É–¥–∞–ª—è—Ç—å—Å—è —á–µ–ª–æ–≤–µ–∫ –∏–∑ –∫–∞–¥—Ä–∞)
    resize_factor=0.5, # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –∫–∞–¥—Ä–∞ (0.5 = 50% –æ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª–∞) ‚Äî —É—Å–∫–æ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É SSIM
    use_parallel=False, # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∫–∞–¥—Ä–æ–≤ (False ‚Äî –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞)
    window_size_sec=2, # –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –¥–ª—è —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ SSIM –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (–±–æ–ª—å—à–µ ‚Äî –±–æ–ª–µ–µ "–≥–ª–∞–¥–∫–∏–π" –ø–æ—Ä–æ–≥)
    min_stable_duration=30 # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ —É—á–∞—Å—Ç–∫–∞ –≤ –∫–∞–¥—Ä–∞—Ö ‚Äî —Ñ–∏–ª—å—Ç—Ä –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å–∫–∞—á–∫–æ–≤
)

# --- –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ ---
keyframes_df = pipeline.run(
    output_keyframes="keyframes.csv", # –ò–º—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ CSV-—Ñ–∞–π–ª–∞ —Å –∫–ª—é—á–µ–≤—ã–º–∏ –∫–∞–¥—Ä–∞–º–∏
    generate_pdf_report=True,   # <-- –≤–∫–ª—é—á–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é PDF
    output_pdf="keyframes_report.pdf", # –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –æ—Ç—á–µ—Ç–∞
    cleanup=True, # –£–¥–∞–ª–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∞ (True ‚Äî —á–∏—Å—Ç–æ, False ‚Äî –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–¥—Ä—ã)
    mp_context=ctx
)
```

## üìÅ **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã**
–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã:

keyframes.csv ‚Äî CSV-—Ñ–∞–π–ª —Å –∫–ª—é—á–µ–≤—ã–º–∏ –∫–∞–¥—Ä–∞–º–∏ –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏
keyframes_report.pdf ‚Äî PDF-–æ—Ç—á—ë—Ç —Å —Ç–∞–±–ª–∏—Ü–µ–π –∏ –ø—Ä–µ–≤—å—é –∫–ª—é—á–µ–≤—ã—Ö –∫–∞–¥—Ä–æ–≤

## ‚öôÔ∏è **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**

video_path - –ü—É—Ç—å –∫ –≤–∏–¥–µ–æ—Ñ–∞–π–ª—É

mask_lector
–ï—Å–ª–∏
True
, –ª–µ–∫—Ç–æ—Ä –∑–∞–∫—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Ä–∞—Å—á—ë—Ç–µ SSIM

resize_factor - –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —É–º–µ–Ω—å—à–µ–Ω–∏—è –∫–∞–¥—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 0.5)

use_parallel - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É

window_size_sec - –î–ª–∏–Ω–∞ –æ–∫–Ω–∞ –¥–ª—è —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö)

min_stable_duration - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ —É—á–∞—Å—Ç–∫–∞ (–≤ –∫–∞–¥—Ä–∞—Ö)

## üìÑ **–ü—Ä–∏–º–µ—Ä –æ—Ç—á—ë—Ç–∞**

–ü—Ä–∏–º–µ—Ä PDF-–æ—Ç—á—ë—Ç–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç:

- –ù–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ
- –¢–∞–±–ª–∏—Ü—É –∫–ª—é—á–µ–≤—ã—Ö –∫–∞–¥—Ä–æ–≤ (–Ω–æ–º–µ—Ä, –≤—Ä–µ–º—è, –ø—É—Ç—å)
- –ü—Ä–µ–≤—å—é –∫–∞–∂–¥–æ–≥–æ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ –∫–∞–¥—Ä–∞

## üìö **–û–±–∑–æ—Ä –∫–ª–∞—Å—Å–æ–≤ –∏ —Ñ—É–Ω–∫—Ü–∏–π**

–í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞ –º–æ–¥—É–ª–∏:

## üß† –ö–ª—é—á–µ–≤—ã–µ –∫–ª–∞—Å—Å—ã:

calculate_pair(args) - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ SSIM –º–µ–∂–¥—É –¥–≤—É–º—è —Å–æ—Å–µ–¥–Ω–∏–º–∏ –∫–∞–¥—Ä–∞–º–∏

KeyframeDetector - –ü–æ–∏—Å–∫ –∫–ª—é—á–µ–≤—ã—Ö –∫–∞–¥—Ä–æ–≤ –ø–æ SSIM

VideoFrameExtractor - –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∫–∞–¥—Ä—ã –∏–∑ –≤–∏–¥–µ–æ

FaceAnalyzer - –ê–Ω–∞–ª–∏–∑ –ª–∏—Ü–∞ –∏ –¥–≤–∏–∂–µ–Ω–∏—è –≥—É–±

BodyPoseAnalyzer - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ç–µ–ª–∞ —á–µ—Ä–µ–∑ MediaPipe

SegmentationProcessor - –ó–∞–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ —á–µ–ª–æ–≤–µ–∫–∞ –≤ ROI

LectorMasker - –ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ –ª–µ–∫—Ç–æ—Ä–∞ –≤ –≤–∏–¥–µ–æ

FrameSaver - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–∞–¥—Ä—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ frame_XXXXXX.jpg

FrameLoader - –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —É–º–µ–Ω—å—à–µ–Ω–∏–µ –∫–∞–¥—Ä–æ–≤

SSIMCalculator - –†–∞—Å—á—ë—Ç —Ü–≤–µ—Ç–æ–≤–æ–≥–æ SSIM

FrameProcessor - –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–ø–∏—Å–∫–∞ –∫–∞–¥—Ä–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

SSIMAnalyzer - –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –∏–ª–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ SSIM

VideoSSIMPipeline - –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –∞–Ω–∞–ª–∏–∑–∞

##  **–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**

–ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç:

‚Ä¢	–î–ª–∏–Ω—ã –≤–∏–¥–µ–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 10 –º–∏–Ω—É—Ç –≤–∏–¥–µ–æ).

‚Ä¢	–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è mask_lector.

‚Ä¢	–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞ (use_parallel=True —É—Å–∫–æ—Ä—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ 2‚Äì4 —Ä–∞–∑–∞).

‚Ä¢	–†–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–∞–¥—Ä–æ–≤ (resize_factor).

## **–û—Ü–µ–Ω–∫–∞:**

‚Ä¢	–í–∏–¥–µ–æ 2 –º–∏–Ω—É—Çs ‚Üí ~30‚Äì120 —Å–µ–∫—É–Ω–¥ (CPU, –±–µ–∑ GPU).

‚Ä¢	–° –º–∞—Å–∫–∏—Ä–æ–≤–∫–æ–π –ª–µ–∫—Ç–æ—Ä–∞ ‚Äî –Ω–∞ 20‚Äì30% –º–µ–¥–ª–µ–Ω–Ω–µ–µ.

‚Ä¢	–° –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–æ–º ‚Äî —É—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–æ 4√ó (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —á–∏—Å–ª–∞ —è–¥–µ—Ä CPU).

________________________________________
## **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:

‚Ä¢	–ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–º–∏ –≤–∏–¥–µ–æ (>1‚Äì2 —á–∞—Å–∞) –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.

‚Ä¢	–î–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏ –ª–µ–∫—Ç–æ—Ä–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è, —á—Ç–æ–±—ã –æ–Ω –±—ã–ª –≤–∏–¥–µ–Ω –≤ –∫–∞–¥—Ä–µ.

‚Ä¢	–¢—Ä–µ–±—É–µ—Ç—Å—è —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–∞–¥—Ä–æ–≤ (~10‚Äì50 –∫–∞–¥—Ä–æ–≤/—Å–µ–∫—É–Ω–¥–∞).

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

‚Ä¢	–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ resize_factor=0.5 –¥–ª—è –±–∞–ª–∞–Ω—Å–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –∫–∞—á–µ—Å—Ç–≤–∞.

‚Ä¢	–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ mask_lector=True –æ–∂–∏–¥–∞–π—Ç–µ –±–æ–ª—å—à–µ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏.

‚Ä¢	–î–ª—è –±–æ–ª—å—à–∏—Ö –≤–∏–¥–µ–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ window_size_sec=10‚Äì30.
